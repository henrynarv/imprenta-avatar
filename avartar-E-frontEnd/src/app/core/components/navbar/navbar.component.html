<!-- Nabar Pricipal -->
<nav
  class="bg-white py-3 border-b border-gray-200 sticky top-0 z-40 backdrop-blur-sm bg-white/95 supports-backdrop-blur:bg-white/60"
  role="navigation"
  aria-label="Navegacion primcipal"
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between items-center">
      <!-- Logo y men煤 Mobile -->
      <div class="flex items-center space-x-4">
        <!-- Logo -->
        <div
          class="flex items-center gap-2 cursor-pointer group"
          (mouseenter)="isHoveredLogo.set(true)"
          (mouseleave)="isHoveredLogo.set(false)"
          (click)="navigateToHome()"
          role="button"
          aria-label="Ir a la pagina principal"
          tabindex="0"
        >
          <img
            [src]="currentLogo()"
            class="w-8 h-8 mr-2 transition-all duration-300 group-hover:scale-110"
            alt="logo"
          />
          <span
            class="text-xl font-bold bg-gradient-to-r from-blue-600 to-indigo-700 bg-clip-text text-transparent"
          >
            E-Imprenta
          </span>
        </div>

        <!-- Boton Men煤 Mobil -->
        <button
          class="md:hidden p-2 rounded-lg text-gray-600 hover:text-gray-900 hover:bg-gray-100 transition-colors duration-200 focus:outline-none focus:ring-2 focus-ring-blue-500 focus:ring-offset-2"
          (click)="toggleMenu()"
          [attr.aria-label]="isMenuOpen() ? 'Cerrar men煤 ' : 'Abrir men煤'"
          [attr.aria-expanded]="isMenuOpen()"
        >
          <ng-icon [name]="isMenuOpen() ? 'heroXMark' : 'heroBars3'"></ng-icon>
        </button>
      </div>

      <!-- Men煤 Desktop -->
      <div class="hidden md:flex items-center space-x-8">
        <!-- Men煤 segun rol -->
        <div class="flex items-center space-x-6">
          @if (role() === 'ROLE_USER') {
          <app-navbar-user-menu></app-navbar-user-menu>
          }@else {
          <app-navbar-admin-menu></app-navbar-admin-menu>
          }
        </div>

        <!-- Carrito y usuario -->
        <div class="flex items-center space-x-4">
          <!-- Carrito -->
          @if (showCart()) {
          <div class="flex items-center">
            <app-cart-badge></app-cart-badge>
          </div>
          }

          <!-- Usuario -->
          @if (isAuthenticated()) {
          <div class="relative" #usreDropdown>
            <button
              (click)="toggleUserDropdown()"
              (keydown.escape)="closeUserDropdown()"
              [class]="getUserItemClasses()"
              aria-haspopup="true"
              [attr.aria-expanded]="isUserDropdownOpen()"
            >
              <div
                class="w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center"
              >
                {{ userInitials() }}
              </div>
              <!-- Avatar -->
              <!-- <img
                [src]="user().avatar"
                alt=""
                [alt]="user().name"
                class="w-8 h-8 rounded-full border-gray-200 group-hover:border-blue-300 transition-colors duration-200"
              /> -->
              <!-- Informaci贸n del usuario -->
              <div class="hidden lg:block text-left">
                <div class="text-sm font-medium text-gray-900 leading-tight">
                  {{ user()?.firstName }}
                </div>
                <div class="text-xs text-gray-500 capitalize">
                  {{ role() === "ROLE_USER" ? "Usuario" : "Administrador" }}
                </div>
              </div>

              <!-- Icono dropdown -->
              <ng-icon
                name="heroChevronDown"
                size="14"
                [class]="
                  isUserDropdownOpen()
                    ? 'text-blue-600 rotate-180'
                    : 'text-gray-400'
                "
                class="transition-transform duration-200"
              ></ng-icon>
            </button>

            <!-- Dropdown Menu -->
            @if (isUserDropdownOpen()) {
            <div
              class="absolute bg-gray-300 right-0 mt-2 w-56 rounded-xl shadow-2xl border border-gray-200 py-2 z-50 animate-dropdown-in"
              (mouseleave)="closeUserDropdown()"
              role="menu"
              aria-orientation="vertical"
            >
              <!-- Header -->

              <div class="px-4 py-3 border-b border-gray-100">
                <p class="text-sm text-medium text-gray-900 truncate">
                  {{ user()?.firstName }} {{ user()?.lastName }}
                </p>
                <p class="text-sm text-gray-500 truncate">
                  {{ user()?.email }}
                </p>
              </div>
              <!-- Items del men煤 -->
              <div class="py-2">
                <!-- Perfil -->
                <button
                  (click)="navigateToProfile()"
                  class="flex items-center space-x-3 w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors duration-150 group"
                  role="menuitem"
                >
                  <ng-icon
                    name="heroUser"
                    class="text-gray-400 group-hover:text-blue-500"
                    size="18"
                  ></ng-icon>
                  <span>Mi Perfil</span>
                </button>

                <!-- Configuracion -->
                <button
                  (click)="navigateToSettings()"
                  class="flex items-center space-x-3 w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors duration-150 group"
                  role="menuitem"
                >
                  <ng-icon
                    name="heroCog6Tooth"
                    class="text-gray-400 group-hover:text-blue-500"
                    size="18"
                  ></ng-icon>
                  <span>Configuraci贸n</span>
                </button>
              </div>

              <!-- Footer -->

              <div class="border-t border-gray-100 pt-2">
                <button
                  (click)="logout()"
                  class="flex items-center space-x-3 w-full px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors duration-150 group"
                  role="menuitem"
                >
                  <ng-icon
                    name="heroArrowRightOnRectangle"
                    class="text-red-400 group-hover:text-red-500"
                    size="18"
                  ></ng-icon>
                  <span>Cerrar Sesi贸n</span>
                </button>
              </div>
            </div>
            }
          </div>
          }@else {
          <!-- Botones de autenticaci贸n -->
          <div class="flex items-center space-x-3">
            <a
              [routerLink]="['/auth/login']"
              class="px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900 transition-colors duration-200"
            >
              Iniciar Sesi贸n
            </a>
            <a
              [routerLink]="['/auth/register']"
              class="px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-all duration-200 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"
            >
              Registrarse
            </a>
          </div>
          }
        </div>

        <!-- Switch de Roles (solo para demo/desarrollo) -->
        <!-- @if (isAuthenticated()) {
        <button
          (click)="switchRole()"
          class="hidden xl:flex items-center space-x-2 px-3 py-2 text-xs border border-gray-300 rounded-lg hover:bg-gray-50 transition-all duration-200 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"
          aria-label="Cambiar rol de usuario"
        >
          <span class="font-medium text-gray-600">
            {{ role() === "user" ? " Usuario" : "锔 Admin" }}
          </span>
          <ng-icon
            name="heroArrowsRightLeft"
            size="12"
            class="text-gray-400"
          ></ng-icon>
        </button>
        } -->
      </div>
    </div>
  </div>

  <!-- Men煤 Mobile -->
  @if (isMenuOpen()) {
  <div
    class="fixed inset-0 bg-black bg-opacity-50 z-50 md:hidden animate-fade-in"
    (click)="closeMobileMenu()"
  >
    <div
      class="absolute top-0 left-0 h-full w-80 max-w-full bg-white shadow-xl transform animate-slide-in-left"
      (click)="$event.stopPropagation()"
      role="dialog"
      aria-label="Men煤 de navegaci贸n m贸vil"
    >
      <!-- Header Mobile -->
      <div
        class="flex items-center justify-between p-4 border-b border-gray-200"
      >
        <div class="flex items-center space-x-3">
          <img [src]="logoUrlColor" class="w-8 h-8" alt="E-Imprenta" />
          <span class="text-lg font-bold text-gray-900">E-Imprenta</span>
        </div>
        <button
          (click)="closeMobileMenu()"
          class="p-2 rounded-lg text-gray-500 hover:text-gray-700 hover:bg-gray-100 transition-colors duration-200"
          aria-label="Cerrar men煤"
        >
          <ng-icon name="heroXMark" size="24"></ng-icon>
        </button>
      </div>

      <!-- Contenido Mobile -->
      <div class="h-full overflow-y-auto">
        <!-- Men煤 seg煤n Rol -->
        <div class="p-4">
          @if (role() === 'ROLE_USER') {
          <app-navbar-user-menu></app-navbar-user-menu>
          } @else {
          <app-navbar-admin-menu></app-navbar-admin-menu>
          }
        </div>

        <!-- Secci贸n de usuario m贸vil -->
        @if (isAuthenticated()) {
        <div class="border-t border-gray-200 p-4">
          <div class="flex items-center space-x-3 mb-4">
            <!-- <img

              [src]="user().avatar"
              [alt]="user().name"
              class="w-10 h-10 rounded-full border-2 border-blue-200"
            /> -->
            <!-- Avatar con iniciales (ya que tu User no tiene avatar) -->
            <div
              class="w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-semibold text-sm"
            >
              {{ userInitials() }}
            </div>
            <div>
              <div class="font-medium text-gray-900">
                {{ user()?.firstName }}
              </div>
              <div class="text-sm text-gray-500">{{ user()?.email }}</div>
            </div>
          </div>

          <div class="space-y-2">
            <button
              (click)="navigateToProfile(); closeMobileMenu()"
              class="w-full text-left px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-lg transition-colors duration-150"
            >
              Mi Perfil
            </button>
            <button
              (click)="navigateToSettings(); closeMobileMenu()"
              class="w-full text-left px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-lg transition-colors duration-150"
            >
              Configuraci贸n
            </button>
            <button
              (click)="logout(); closeMobileMenu()"
              class="w-full text-left px-3 py-2 text-sm text-red-600 hover:bg-red-50 rounded-lg transition-colors duration-150"
            >
              Cerrar Sesi贸n
            </button>
          </div>
        </div>
        } @else {
        <div class="border-t border-gray-200 p-4 space-y-3">
          <a
            [routerLink]="['/auth/login']"
            (click)="closeMobileMenu()"
            class="block w-full text-center px-4 py-2 text-sm font-medium text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-200"
          >
            Iniciar Sesi贸n
          </a>
          <a
            [routerLink]="['/auth/register']"
            (click)="closeMobileMenu()"
            class="block w-full text-center px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors duration-200"
          >
            Registrarse
          </a>
        </div>
        }
      </div>
    </div>
  </div>
  }
</nav>

<!--
<nav
  class="bg-gray-100 px-6 py-3 flex justify-between items-center w-full relative"
>
  LOGO
  <div
    class="flex items-center gap-2 cursor-pointer"
    (mouseenter)="isHoveredLogo.set(true)"
    (mouseleave)="isHoveredLogo.set(false)"
    [ngClass]="{ 'opacity-60': !isHoveredLogo() }"
  >
    <img
      [src]="getLogo()"
      class="w-8 h-8 mr-2 transition-opacity duration-300"
      [ngClass]="{
        'opacity-60': !isHoveredLogo(),
        'opacity-100': isHoveredLogo()
      }"
      alt="logo"
    />

    <span class="font-bold">E-Imprenta</span>

  </div>

  BOTON AMBURGUESA (solo movil)
  <button class="md:hidden" (click)="toggleMenu()">
    <ng-icon name="heroBars3" size="24"></ng-icon>
  </button>

  MENU DESKTOP
  <div class="hidden md:block">
    @if(role() === 'client'){
    <app-navbar-user-menu></app-navbar-user-menu>
    }@else {
    <app-navbar-admin-menu></app-navbar-admin-menu>
    }
  </div>

  USUARIO y CARRITO
  <div class="hidden md:flex items-center gap-4">
    carrito
    <div class="flex items-center gap-1 cursor-pointer hover:text-primary">
      <ng-icon name="heroShoppingCartSolid" size="22"></ng-icon>
      <span></span>
      <app-cart-badge></app-cart-badge>
    </div>

    Usuario
    <div class="flex items center gap-2">
      <img [src]="user().avatar" alt="user" class="w-8 h-8 rounded-full" />
      <span class="font-medium">{{ user().name }}</span>
    </div>
  </div>

  SHITCH DE ROLES(solo para demo)
  <button
    (click)="switchRole()"
    class="ml-4 text-xs border px-2 py.1 rounded-md hover:bg-gray-200"
  >
    {{ role() === "client" ? "user" : "admin" }}
  </button>
</nav>

MENU MOBILE
@if (isMenuOpen()) {
<div
  class="fixed inset-0 bg-black bg-opacity-90 text-white z-50 p-6 md:hidden overflow-x-auto"
>
  cerrar
  <button class="mb-6" (click)="toggleMenu()">
    <ng-icon name="heroXMark" size="24"></ng-icon>
  </button>

  @if (role() === 'client') {
  <app-navbar-user-menu></app-navbar-user-menu>
  }@else {
  <app-navbar-admin-menu></app-navbar-admin-menu>
  }
</div>
}
 -->
