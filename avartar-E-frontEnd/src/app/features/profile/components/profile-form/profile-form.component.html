<!-- Fomulario de edicion del perfil -->

<form [formGroup]="profileForm" (ngSubmit)="onSubmit()">
  <!-- Información b{asica -->
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    <!-- Nombre -->
    <div>
      <label for="name" class="block text-sm font-medium text-gray-700 mb-2">
        Nombre Completo *
      </label>

      <div class="relative">
        <div
          class="absolute inset-0 left-0 pl-3 flex items-center pointer-events-none"
        >
          <ng-icon name="heroUser" size="20" class="text-gray-400"></ng-icon>
        </div>
        <input
          id="name"
          type="text"
          formControlName="name"
          [class]="getInputClasses(profileForm.controls.name)"
          class="pl-10 pr-4"
          placeholder="Nombre Completo"
        />
      </div>

      @if (profileForm.controls.name.touched &&
      profileForm.controls.name.invalid) {
      <p class="mt-1 text-sm text-red-600 animate-fade-in">
        {{ getErrorMessage("name") }}
      </p>
      }
    </div>

    <!-- Email -->
    <div>
      <label for="email" class="block text-sm font-medium text-gray-700 mb-2">
        Correo Elctrónico *
      </label>
      <div class="relative">
        <div
          class="absolute inset-0 left-0 pl-3 flex items-center pointer-events-none"
        >
          <ng-icon
            name="heroEnvelope"
            size="20"
            class="text-gray-400"
          ></ng-icon>
        </div>
        <input
          id="email"
          type="text"
          formControlName="email"
          [class]="getInputClasses(profileForm.controls.email)"
          class="pl-10 pr-4"
          placeholder="micorreo@gmail.com"
        />
      </div>
      @if (profileForm.controls.email.touched &&
      profileForm.controls.email.invalid) {
      <p class="mt-1 text-sm text-red-600 animate-fade-in">
        {{ getErrorMessage("email") }}
      </p>
      }
    </div>
  </div>
  <!-- INformación de contacto -->
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mt-3">
    <!-- Teléfono -->
    <div>
      <label for="phone" class="block text-sm font-medium text-gray-700 mb-2">
        Telefono
      </label>
      <div class="relative">
        <div
          class="absolute inset-0 left-0 pl-3 flex items-center pointer-events-none"
        >
          <ng-icon name="heroPhone" size="20" class="text-gray-400"></ng-icon>
        </div>
        <input
          id="phone"
          type="tel"
          formControlName="phone"
          [class]="getInputClasses(profileForm.controls.phone)"
          class="pl-10 pr-4"
          placeholder="+56 9 1234 5678"
        />
      </div>
      <p class="mt-1 text-sm text-gray-500">Opcional</p>
    </div>

    <!-- Empresa -->
    <div>
      <label for="company" class="block text-sm font-medium text-gray-700 mb-2">
        Empresa
      </label>

      <div class="relative">
        <div
          class="absolute inset-0 left-0 pl-3 flex items-center pointer-events-none"
        >
          <ng-icon
            name="heroBuildingOffice"
            size="20"
            class="text-gray-400"
          ></ng-icon>
        </div>
        <input
          id="company"
          type="text"
          formControlName="company"
          [class]="getInputClasses(profileForm.controls.company)"
          class="pl-10 pr-4"
          placeholder="Nombre de la empresa"
        />
      </div>
      <p class="mt-1 text-sm text-gray-500">Opcional</p>
    </div>
  </div>

  <!-- Botones de acción -->
  <div class="flex flex-col sm:flex-row gap-4 pt-6 border-t border-gray-200">
    <button
      type="submit"
      [disabled]="!canSave()"
      [class]="
        canSave()
          ? 'bg-blue-600 hover:bg-blue-700 transform hover:scale-105'
          : 'bg-gray-400 cursor-not-allowed'
      "
      class="flex items-center space-x-2 px-6 py-3 text-white rounded-lg font-semibold transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 min-w-[120px] justify-center"
    >
      @if (isLoading()) {
      <!-- Loading Spinner -->
      <div
        class="w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"
      ></div>
      <span>Guardando...</span>
      } @else {
      <ng-icon name="heroCheck" size="20"></ng-icon>
      <span>Guardar</span>
      }
    </button>

    <!-- Botón Cancelar -->
    <button
      type="button"
      (click)="onCancel()"
      [disabled]="isLoading()"
      class="flex items-center space-x-2 px-6 py-3 border border-gray-300 text-gray-700 rounded-lg font-semibold hover:bg-gray-50 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500"
    >
      <ng-icon name="heroXMark" size="20"></ng-icon>
      <span>Cancelar</span>
    </button>
  </div>

  <!-- Mensaje de cambios -->
  @if (!hasformChanged() && profileForm.touched) {
  <div
    class="bg-blue-50 border border-blue-200 rounded-lg p-4 mt-2 animate-fade-in"
  >
    <div class="flex items-center space-x-2 text-blue-800">
      <ng-icon name="heroInformationCircle" size="20"></ng-icon>
      <span class="text-sm font-medium">No hay cambios para guardar</span>
    </div>
  </div>
  }
</form>
