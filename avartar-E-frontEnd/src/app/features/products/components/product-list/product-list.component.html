<!--
  <div
  class="p-6 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6"
  >
  @for (product of products(); track product.id) {
    <app-product-card [product]="product"></app-product-card>
  }
</div>

-->

<div class="space-y-6">
  <!-- Filtros y Ordenamiento -->
  @if (showFilters()) {
  <div class="bg-white rounded-2xl shadow-sm border border-gray-200 p-6">
    <div
      class="flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0"
    >
      <!-- Búsqueda -->
      <div class="flex-1 max-w-md">
        <div class="relative">
          <input
            type="text"
            placeholder="Buscar productos..."
            [value]="searchText()"
            (input)="onSearchTextChange($any($event.target).value)"
            class="w-full border border-gray-300 rounded-lg px-4 py-3 pl-10 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white"
          />
          <div
            class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"
          >
            <svg
              class="h-5 w-5 text-gray-400"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
              />
            </svg>
          </div>
        </div>
      </div>

      <!-- Controles de Filtro -->
      <div class="flex flex-wrap items-center gap-4">
        <!-- Filtro por Categoría -->
        <select
          [value]="selectedCategory()"
          (change)="onCategoryChange($any($event.target).value)"
          class="border border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white"
        >
          <option value="">Todas las categorías</option>
          @for (category of getCategories(); track category) {
          <option [value]="category">
            {{ formatCategoryName(category) }}
          </option>
          }
        </select>

        <!-- Filtro por Stock -->
        <label class="flex items-center space-x-2 cursor-pointer">
          <input
            type="checkbox"
            [checked]="inStockOnly()"
            (change)="onStockToggle()"
            class="rounded border-gray-300 text-blue-600 focus:ring-blue-500"
          />
          <span class="text-sm text-gray-700">Solo en stock</span>
        </label>

        <!-- Ordenamiento -->
        <div class="flex items-center space-x-2">
          <select
            [value]="sortBy()"
            (change)="onSortChange($any($event.target).value)"
            class="border border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white"
          >
            <option value="newest">Más recientes</option>
            <option value="name">Nombre</option>
            <option value="price">Precio</option>
            <option value="rating">Rating</option>
          </select>

          <!-- Botón de orden -->
          <button
            (click)="onSortOrderToggle()"
            [class]="
              sortOrder() === 'asc'
                ? 'bg-blue-600 text-white'
                : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
            "
            class="p-3 rounded-lg transition-all duration-200 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"
            [attr.aria-label]="
              sortOrder() === 'asc' ? 'Orden ascendente' : 'Orden descendente'
            "
          >
            <svg
              class="w-5 h-5"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              @if (sortOrder() === 'asc') {
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M3 4h13M3 8h9m-9 4h6m4 0l4-4m0 0l4 4m-4-4v12"
              />
              } @else {
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M3 4h13M3 8h9m-9 4h9m5-4v12m0 0l-4-4m4 4l4-4"
              />
              }
            </svg>
          </button>
        </div>

        <!-- Limpiar Filtros -->
        <button
          (click)="clearFilters()"
          class="px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-all duration-200 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"
        >
          Limpiar
        </button>
      </div>
    </div>
  </div>
  }

  <!-- Contenido Principal -->
  <div class="space-y-6">
    <!-- Loading State -->
    @if (loading() && products().length === 0) {
    <div class="flex items-center justify-center p-12">
      <div class="text-center space-y-4">
        <svg
          class="animate-spin mx-auto h-12 w-12 text-blue-600"
          fill="none"
          viewBox="0 0 24 24"
        >
          <circle
            class="opacity-25"
            cx="12"
            cy="12"
            r="10"
            stroke="currentColor"
            stroke-width="4"
          ></circle>
          <path
            class="opacity-75"
            fill="currentColor"
            d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
          ></path>
        </svg>
        <p class="text-gray-600 text-lg">Cargando productos...</p>
      </div>
    </div>
    }

    <!-- Empty State -->
    @else if (products().length === 0 && !loading()) {
    <div class="flex items-center justify-center p-12">
      <div class="text-center space-y-4">
        <svg
          class="mx-auto h-16 w-16 text-gray-400"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="1"
            d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2M4 13h2m8 0v4m-4-4v4"
          />
        </svg>
        <h3 class="text-xl font-semibold text-gray-900">
          No se encontraron productos
        </h3>
        <p class="text-gray-600 max-w-md">{{ emptyMessage() }}</p>
        @if (showFilters()) {
        <button
          (click)="clearFilters()"
          class="mt-4 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"
        >
          Ver todos los productos
        </button>
        }
      </div>
    </div>
    }

    <!-- Grid de Productos -->
    @else if (products().length > 0) {
    <div [class]="gridClasses()">
      @for (product of products(); track trackByProductId($index, product)) {
      <app-product-card
        [product]="product"
        [showActions]="true"
        [showDescription]="true"
        [size]="layout() === 'grid' ? 'md' : 'lg'"
        (productClicked)="onProductSelected($event)"
        (addToCartClicked)="onAddToCart($event)"
        (quickViewClicked)="onQuickView($event)"
        class="animate-fade-in"
      ></app-product-card>
      }
    </div>
    }
  </div>
</div>
